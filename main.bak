%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Frame
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

frame risk
default tempMin is 0
and default tempMax is 0
and default chuvaTotal is 0
and default chuvaMax is 0
and default p10 is 0
and default no is 0
and default no2 is 0
and default nox is 0
and default so2 is 0
and default co2 is 0
and default o3 is 0.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fuzzy Variables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fuzzy_variable tempMin ;
   ranges from -5 to  15 ; 
   fuzzy_set verde_tMin is \ shaped and linear at -5, 0 ; 
   fuzzy_set amarelo_tMin is /\ shaped and linear at 0, 5, 10 ; 
   fuzzy_set laranja_tMin is /\ shaped and linear at 4, 9, 15 ; 
   fuzzy_set vermelho_tMin is / shaped and linear at 10, 15 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 

%FE tempMax edited at 15:27:53 on 26/12/2016
fuzzy_variable tempMax ;
   ranges from 10 to  30 ; 
   fuzzy_set verde_tMax is \ shaped and linear at 10, 15 ; 
   fuzzy_set amarelo_tMax is /\ shaped and linear at 13, 15, 20 ; 
   fuzzy_set laranja_tMax is /\ shaped and linear at 15, 20, 25 ; 
   fuzzy_set vermelho_tMax is / shaped and linear at 20, 30 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 


fuzzy_variable color ;
   ranges from 0 to  25 ; 
   fuzzy_set verde is \ shaped and linear at 0, 7 ; 
   fuzzy_set vermelho is / shaped and linear at 15, 20 ; 
   fuzzy_set amarelo is /\ shaped and linear at 5, 10, 15 ; 
   fuzzy_set laranja is /\ shaped and linear at 10, 15, 20 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking .

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Matriz de regras
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fuzzy_matrix risk_value
	tempMin		*  tempMax		->  color	; 
   	verde_tMin   	*  verde_tMax    	->  verde  	;
   	verde_tMin   	*  amarelo_tMax	->  verde  	;
   	verde_tMin   	*  laranja_tMax	->  amarelo	;
   	verde_tMin   	*  vermelho_tMax	->  laranja	;
   	amarelo_tMin   	*  verde_tMax	->  verde	;
	amarelo_tMin   	*  amarelo_tMax	->  amarelo	;
	amarelo_tMin   	*  laranja_tMax	->  amarelo	;
	amarelo_tMin   	*  vermelho_tMax	->  laranja	;  
   	laranja_tMin   	*  verde_tMax	->  amarelo	;
	laranja_tMin   	*  amarelo_tMax	->  amarelo	;
	laranja_tMin   	*  laranja_tMax	->  laranja	;
	laranja_tMin   	*  vermelho_tMax	->  laranja	;
   	vermelho_tMin   	*  verde_tMax	->  amarelo	;
	vermelho_tMin   	*  amarelo_tMax	->  laranja	;
	vermelho_tMin   	*  laranja_tMax	->  laranja	;
	vermelho_tMin   	*  vermelho_tMax	->  vermelho.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Propagação dos valores fuzzy  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%example: get_risk(12, 30, Risk).
relation get_risk(TempMin, TempMax, Risk)
if reset all fuzzy values
and fuzzify the tempMin from TempMin
and fuzzify the tempMax from TempMax
and propagate risk_value fuzzy rules
and defuzzify the color to Risk.

 
%FE chuvaTotal created at 15:38:21 on 26/12/2016
fuzzy_variable chuvaTotal ;
   ranges from 0 to  300 ; 
   fuzzy_set verde_chuvaTotal is \ shaped and linear at 0, 100 ; 
   fuzzy_set amarelo_chuvaTotal is /\ shaped and linear at 50, 125, 200 ; 
   fuzzy_set laranja_chuvaTotal is /\ shaped and linear at 150, 225, 300 ; 
   fuzzy_set vermelho_chuvaTotal is / shaped and linear at 200, 300 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 
%FE chuvaMax created at 15:43:57 on 26/12/2016
fuzzy_variable chuvaMax ;
   ranges from 0 to  100 ; 
   fuzzy_set verde_chuvaMax is \ shaped and linear at 20, 40 ; 
   fuzzy_set amarelo_chuvaMax is /\ shaped and linear at 20, 40, 60 ; 
   fuzzy_set laranja_chuvaMax is /\ shaped and linear at 40, 60, 80 ; 
   fuzzy_set vermelho_chuvaMax is / shaped and linear at 60, 80 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 
%FE p10 edited at 15:50:25 on 26/12/2016
fuzzy_variable p10 ;
   ranges from 20 to  40 ; 
   fuzzy_set verde_p10 is / shaped and linear at 30, 35 ; 
   fuzzy_set amarelo_p10 is /\ shaped and linear at 24, 27, 30 ; 
   fuzzy_set laranja_p10 is /\ shaped and linear at 20, 24, 27 ; 
   fuzzy_set vermelho_p10 is \ shaped and linear at 20, 24 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 
%FE no created at 15:54:50 on 26/12/2016
fuzzy_variable no ;
   ranges from 10 to  50 ; 
   fuzzy_set verde_no is \ shaped and linear at 18, 24 ; 
   fuzzy_set amarelo_no is /\ shaped and linear at 20, 30, 37 ; 
   fuzzy_set laranja_no is /\ shaped and linear at 29, 35, 40 ; 
   fuzzy_set vermelho_no is / shaped and linear at 40, 45 ; 
   defuzzify using 
      all memberships
       and mirror rule
       and shrinking . 
